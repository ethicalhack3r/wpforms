"use strict";var WPFormsFormEmbedWizard=window.WPFormsFormEmbedWizard||function(o,n){var a={},t={formId:0,isBuilder:!1,isChallengeActive:!1},r={init:function(){n(r.ready),n(o).on("load",r.load)},ready:function(){r.initVars(),r.events()},load:function(){"1"!==wpforms_admin_form_embed_wizard.is_edit_page||t.isChallengeActive||r.initTooltip(),r.initialStateToggle()},initVars:function(){a={$wizardContainer:n("#wpforms-admin-form-embed-wizard-container"),$wizard:n("#wpforms-admin-form-embed-wizard"),$contentInitial:n("#wpforms-admin-form-embed-wizard-content-initial"),$contentSelectPage:n("#wpforms-admin-form-embed-wizard-content-select-page"),$contentCreatePage:n("#wpforms-admin-form-embed-wizard-content-create-page"),$sectionBtns:n("#wpforms-admin-form-embed-wizard-section-btns"),$sectionGo:n("#wpforms-admin-form-embed-wizard-section-go"),$newPageTitle:n("#wpforms-admin-form-embed-wizard-new-page-title"),$selectPage:n("#wpforms-admin-form-embed-wizard-select-page"),$videoTutorial:n("#wpforms-admin-form-embed-wizard-tutorial"),$sectionToggles:n("#wpforms-admin-form-embed-wizard-section-toggles"),$sectionGoBack:n("#wpforms-admin-form-embed-wizard-section-goback"),$shortcode:n("#wpforms-admin-form-embed-wizard-shortcode")},t.isBuilder="undefined"!=typeof WPFormsBuilder,t.isChallengeActive="undefined"!=typeof WPFormsChallenge,t.pagesExists=1===a.$wizard.data("pages-exists")},events:function(){a.$wizard.on("click","button",r.popupButtonsClick).on("click",".tutorial-toggle",r.tutorialToggle).on("click",".shortcode-toggle",r.shortcodeToggle).on("click",".initialstate-toggle",r.initialStateToggle).on("click",".wpforms-admin-popup-close",r.closePopup)},popupButtonsClick:function(e){var o=n(e.target);if(o.length){var t=o.closest("div"),i=o.data("action")||"";switch(a.$contentInitial.hide(),i){case"select-page":a.$newPageTitle.hide(),a.$contentSelectPage.show();break;case"create-page":a.$selectPage.hide(),a.$contentCreatePage.show();break;case"go":if(a.$selectPage.is(":visible")&&""===a.$selectPage.val())return;return o.prop("disabled",!0),void r.saveFormAndRedirect()}t.hide(),t.next().fadeIn(),a.$sectionToggles.hide(),a.$sectionGoBack.fadeIn(),r.tutorialControl("Stop")}},tutorialToggle:function(e){e.preventDefault(),a.$shortcode.hide(),a.$videoTutorial.toggle(),a.$videoTutorial[0].src.indexOf("&autoplay=1")<0?r.tutorialControl("Play"):r.tutorialControl("Stop")},tutorialControl:function(e){var o=a.$videoTutorial[0];void 0!==o&&("Stop"!==e?o.src+=o.src.indexOf("&autoplay=1")<0?"&autoplay=1":"":o.src=o.src.replace("&autoplay=1",""))},shortcodeToggle:function(e){e.preventDefault(),a.$videoTutorial.hide(),r.tutorialControl("Stop"),a.$shortcode.val('[wpforms id="'+t.formId+'" title="false" description="false"]'),a.$shortcode.toggle()},initialStateToggle:function(e){e&&e.preventDefault(),t.pagesExists?(a.$contentInitial.show(),a.$contentSelectPage.hide(),a.$contentCreatePage.hide(),a.$selectPage.show(),a.$newPageTitle.show(),a.$sectionBtns.show(),a.$sectionGo.hide()):(a.$contentInitial.hide(),a.$contentSelectPage.hide(),a.$contentCreatePage.show(),a.$selectPage.hide(),a.$newPageTitle.show(),a.$sectionBtns.hide(),a.$sectionGo.show()),a.$shortcode.hide(),a.$videoTutorial.hide(),r.tutorialControl("Stop"),a.$sectionToggles.show(),a.$sectionGoBack.hide()},saveFormAndRedirect:function(){t.isBuilder&&!WPFormsBuilder.formIsSaved()?t.isBuilder&&t.isChallengeActive?WPFormsBuilder.formSave().done(r.embedPageRedirect):n.confirm({title:!1,content:wpforms_builder.exit_confirm,icon:"fa fa-exclamation-circle",type:"orange",backgroundDismiss:!1,closeIcon:!1,buttons:{confirm:{text:wpforms_builder.save_embed,btnClass:"btn-confirm",keys:["enter"],action:function(){WPFormsBuilder.formSave().done(r.embedPageRedirect)}},cancel:{text:wpforms_builder.embed,action:function(){WPFormsBuilder.setCloseConfirmation(!1),r.embedPageRedirect()}}}}):r.embedPageRedirect()},embedPageRedirectAjaxData:function(){var e={action:"wpforms_admin_form_embed_wizard_embed_page_url",_wpnonce:wpforms_admin_form_embed_wizard.nonce,formId:t.formId};return a.$selectPage.is(":visible")&&(e.pageId=a.$selectPage.val()),a.$newPageTitle.is(":visible")&&(e.pageTitle=a.$newPageTitle.val()),e},embedPageRedirect:function(){var e=r.embedPageRedirectAjaxData();void 0!==e.pageId&&""===e.pageId||n.post(ajaxurl,e,function(e){e.success&&(o.location=e.data)})},openPopup:function(e){e=e||0,t.formId=t.isBuilder?n("#wpforms-builder-form").data("id"):e,a.$wizard.toggleClass("wpforms-challenge-popup",t.isChallengeActive),a.$wizard.find(".wpforms-admin-popup-close").toggle(!t.isChallengeActive),a.$wizard.find(".wpforms-admin-popup-content-regular").toggle(!t.isChallengeActive),a.$wizard.find(".wpforms-admin-popup-content-challenge").toggle(t.isChallengeActive),0===a.$selectPage.length?(a.$sectionBtns.hide(),a.$sectionGo.show()):(a.$sectionBtns.show(),a.$sectionGo.hide()),a.$newPageTitle.show(),a.$selectPage.show(),a.$wizardContainer.fadeIn()},closePopup:function(){a.$wizardContainer.fadeOut(),r.initialStateToggle()},initTooltip:function(){var e=n('<span class="wpforms-challenge-dot wpforms-challenge-dot-step5" data-wpforms-challenge-step="5">&nbsp;</span>'),o=r.isGutenberg(),t=o?".block-editor .edit-post-header":"#wp-content-editor-tools .wpforms-insert-form-button",i={content:n("#tooltip-content5"),trigger:"custom",interactive:!0,animationDuration:0,delay:0,theme:["tooltipster-default","wpforms-challenge-tooltip"],side:o?"bottom":"right",distance:3,functionReady:function(e,o){n(o.tooltip).addClass("wpforms-challenge-tooltip-step5"),e._$tooltip.on("click","button",function(){e.close(),n(".wpforms-challenge-dot.wpforms-challenge-dot-step5").remove()}),e.reposition()}};e.insertAfter(t).tooltipster(i).tooltipster("open")},isGutenberg:function(){return"undefined"!=typeof wp&&Object.prototype.hasOwnProperty.call(wp,"blocks")}};return r}((document,window),jQuery);WPFormsFormEmbedWizard.init();
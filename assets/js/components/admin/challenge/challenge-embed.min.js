"use strict";var WPFormsChallenge=window.WPFormsChallenge||{};WPFormsChallenge.embed=window.WPFormsChallenge.embed||function(e,p){var t={init:function(){p(t.ready),p(e).on("load",t.load)},ready:function(){t.setup(),t.events(),t.observeFullscreenMode()},load:function(){if(-1<e.location.href.indexOf("post-new.php"))return t.lastStep(),void p(".wpforms-challenge-dot-completed").hide();WPFormsChallenge.core.isGutenberg()?WPFormsChallenge.core.initTooltips(5,".block-editor .edit-post-header",{side:"bottom"}):WPFormsChallenge.core.initTooltips(5,".wpforms-insert-form-button",{side:"right"}),WPFormsChallenge.core.updateTooltipUI()},setup:function(){5===WPFormsChallenge.core.loadStep()&&(p(".wpforms-challenge").addClass("wpforms-challenge-completed"),t.showPopup()),p(".wpforms-challenge").show()},events:function(){p(".wpforms-challenge-step5-done").on("click",t.lastStep),p(".wpforms-challenge-popup-close, .wpforms-challenge-popup-rate-btn, .wpforms-challenge-end").on("click",t.completeChallenge),p("#wpforms-challenge-contact-form .wpforms-challenge-popup-contact-btn").on("click",t.submitContactForm)},lastStep:function(){WPFormsChallenge.core.timer.pause(),WPFormsChallenge.core.stepCompleted(5),p(".wpforms-challenge").addClass("wpforms-challenge-completed"),t.showPopup()},showPopup:function(){var e=WPFormsChallenge.core.timer.getSecondsLeft();if(p(".wpforms-challenge-popup-container").show(),0<e){var o=WPFormsChallenge.core.timer.getSecondsSpent(e);p("#wpforms-challenge-congrats-minutes").text(WPFormsChallenge.core.timer.getMinutesFormatted(o)),p("#wpforms-challenge-congrats-seconds").text(WPFormsChallenge.core.timer.getSecondsFormatted(o)),p("#wpforms-challenge-congrats-popup").show()}else p("#wpforms-challenge-contact-popup").show()},hidePopup:function(){p(".wpforms-challenge-popup-container").hide(),p(".wpforms-challenge-popup").hide()},completeChallenge:function(){var e={status:"completed",seconds_spent:WPFormsChallenge.core.timer.getSecondsSpent(),seconds_left:WPFormsChallenge.core.timer.getSecondsLeft()};t.hidePopup(),WPFormsChallenge.core.removeChallengeUI(),WPFormsChallenge.core.clearLocalStorage(),WPFormsChallenge.admin.saveChallengeOption(e).done(WPFormsChallenge.core.triggerPageSave)},submitContactForm:function(e){e.preventDefault();var o=p(this),n=o.closest("#wpforms-challenge-contact-form"),l={action:"wpforms_challenge_send_contact_form",_wpnonce:WPFormsChallenge.admin.l10n.nonce,contact_data:{message:n.find(".wpforms-challenge-contact-message").val(),contact_me:n.find(".wpforms-challenge-contact-permission").prop("checked")}};o.prop("disabled",!0),p.post(ajaxurl,l,function(e){e.success||console.error("Error sending WPForms Challenge Contact Form.")}).done(t.completeChallenge)},observeFullscreenMode:function(){var a=p("body"),c=a.hasClass("is-fullscreen-mode"),e={targetNode:a[0],config:{attributes:!0},callback:function(e,o){var n,l,t=p(".wpforms-challenge-tooltip-step5"),s=t.find(".tooltipster-arrow");for(var r in e)"attributes"===(n=e[r]).type&&"class"===n.attributeName&&(l=a.hasClass("is-fullscreen-mode"))!==c&&((c=l)?(t.css({top:"93px",left:"0"}),s.css("left","91px")):(t.css({top:"125px",left:"66px"}),s.css("left","130px")))}};e.observer=new MutationObserver(e.callback),e.observer.observe(e.targetNode,e.config)}};return t}((document,window),jQuery),WPFormsChallenge.embed.init();